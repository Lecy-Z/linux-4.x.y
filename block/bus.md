## 1. 总线系统

尽管外设的范围可能看上去是无限的：从CD刻录机、调制解调器、ISDN板到照相机和声卡等，但这些都有一个共同点。它们并不直接连接到CPU，而是通过总线连接起来。总线负责设备与CPU之间以及各个设备之间的通信。有很多方法可以实现总线，其中大多数方法Linux都能够支持。以下列出了一些代表性的总线。

### PCI（Peripheral Component Interconnect）：

许多体系结构上使用的主要系统总线。因而在本章的后续部分，我们将仔细考察PCI的特性及其在内核中的实现。PCI设备插入到系统主板的扩展槽中。该总线的现代版本也支持热插拔，使得设备可以在系统运行时连入或断开（尽管该选项很少使用，内核源代码仍然支持此功能）。PCI的传输速度最大能够达到每秒几百兆字节，所以应用得非常广泛。

### ISA（Industrial Standard Architecture）：

一种比较古老的总线，应用仍然很广泛（这一点令人遗憾）。因为ISA在电学原理上非常简单，这使得爱好者和小公司很容易设计制造额外的硬件。这也正是IBM在PC发展早期引入该总线的意图。但随着时间推移，该总线引起了越来越多的问题，在更高级的系统中最终被替换掉。ISA与IA-32体系结构（及其前辈）的某些特性绑定非常紧密，但也可以用于其他的处理器。

### SBus：

这是一个非常高级的总线，不过已经出现很多年了。它由SUN公司设计，是一种非私有的开放总线，但未能在其他体系结构上为自身赢得一个位置。尽管SUN公司基于UltraSparc的更新机型在向PCI的方向转移，但SBus仍然在旧一点的SparcStation上发挥着重要作用，因此Linux支持了该总线。

### IEEE1394：

对市场而言，这显然不是一个较通俗的名字。因而某些厂商将其称之为FireWire，而另一些则称之为I.link。它有几个非常有趣的技术特性，包括预先设计的热插拔能力、非常高的传输速率。IEEE1394是高端笔记本电脑上非常流行的一种外部总线，提供了一种高速的扩展选项。

### USB（Universal Serial Bus）：

这也是一种广泛应用的外部总线，有很高的市场接受度。该总线的主要特性是热插拔能力，及其自动检测新硬件的能力。其最高速度只是中等水平，但足以用于CD刻录机、键盘、鼠标之类的设备。该总线的一种新版本（2.0）的最大传输速率更大，但实际上软件没什么变化（硬件层次上的差别要大得多，但幸运的是我们无需操心这些）。USB系统的拓扑结构异乎寻常，其中的设备不是按一条单链排布，而是按树型结构排布。在内核寻址此类设备时，该事实就显而易见了。USB集线器用作树的结点，在它上面可以进一步连接其他设备（包括其他USB集线器）。USB还有一个异乎寻常的特性，可以为各个设备预留固定的带宽。在实现均匀数据流时，这是一个重要因素。

### SCSI（Small Computer System Interface）：

这种总线过去称为专业人员的总线，因为相关外设的成本很高。由于SCSI支持非常高的数据吞吐率，因此它主要用在服务器系统上寻址硬盘，可适用于大多数处理器体系结构。它很少用于工作站系统，因为与其他总线相比，SCSI的电气安装非常复杂（每个SCSI链都必须终结，才能正常工作。

### 并口与串口（Parallel and Serial Interface）：

这些存在于大多数体系结构上，无论整个系统的设计如何。这些总线非常简单而速率极低，用于外部连接，已经非常古老。这些总线用于寻址慢速设备（如打印机、调制解调器和键盘等），此类设备没什么性能要求。

无论采用的处理器体系结构如何，系统都不会只有一种总线，而是一些总线的组合。当前的PC设计通常包括两个通过桥接器互连的PCI总线。出于兼容性的原因，有时也带有ISA总线（大多数情况下只有一个插槽）。一些总线（如USB或FireWire）无法作为主总线，始终需要经由另一个系统总线将数据传递给处理器。图6-2说明了系统中不同总线的连接方式。

[CPU vs BUS](./bus.png)
