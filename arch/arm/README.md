# ARM

ARM Linux有处理器有6个模式：

* 用户模式(usr)：ARM处理器正常的程序执行状态。
* 外部中断模式(irq)：用于通用的中断处理。
* 管理模式(svc)：操作系统使用的保护模式。
* 数据访问终止模式(abt)：当数据或指令预取终止时进入该模式，可用于虚拟存储及存储保护。
* 未定义指令中止模式(und)：当未定义的指令执行时进入该模式，可用于支持硬件协处理器的软件仿真。

https://github.com/novelinux/linux-4.x.y/tree/master/arch/arm/register.jpg

其中，r0-r12、pc、cpsr这几个寄存器是多个模式下共用的，sp、lr、spsr是每种模式各用各的。

程序在用户态运行，当发生系统调用、异常、中断等事件，就会切换到另一个模式，

此时CPU硬件会做如下几种事情：

1、关中断
2、将cpsr的值保存到目标模式的spsr中
3、通过修改cpsr的模式位，切换到目标模式。
4、将当前pc值加上一定偏移（0或4），写入到目标模式的lr中。
5、将pc值指向异常向量表
之后就会执行异常处理流程。